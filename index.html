<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Tiến Lên L\xean Miền Nam - 4 Người Chơi</title>
  <style>
    body {
      margin: 0;
      font-family: Arial;
      background-color: green;
      color: white;
    }
    .table {
      display: grid;
      grid-template-areas:
        "top top top"
        "left center right"
        "bottom bottom bottom";
      grid-template-rows: 1fr 3fr 1fr;
      grid-template-columns: 1fr 2fr 1fr;
      height: 100vh;
      gap: 10px;
      padding: 10px;
    }
    .player {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .hand {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }
    .card {
      width: 60px;
      height: 90px;
      background: white;
      color: black;
      border-radius: 6px;
      margin: 3px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      cursor: pointer;
    }
    .card.selected {
      transform: translateY(-20px);
      box-shadow: 0 0 8px yellow;
    }
    .card.back {
      background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/5/54/Card_back_01.svg/120px-Card_back_01.svg.png') no-repeat center/cover;
      color: transparent;
    }
    #played-cards {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      font-size: 24px;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 18px;
      background: orange;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="played-cards"></div>
  <div class="table">
    <div class="player" style="grid-area: top;">
      <div>Máy 1</div>
      <div class="hand" id="hand-top"></div>
    </div>
    <div class="player" style="grid-area: left;">
      <div>Máy 2</div>
      <div class="hand" id="hand-left"></div>
    </div>
    <div class="player" style="grid-area: right;">
      <div>Máy 3</div>
      <div class="hand" id="hand-right"></div>
    </div>
    <div class="player" style="grid-area: bottom;">
      <div>Bạn</div>
      <div class="hand" id="hand-bottom"></div>
      <button onclick="playCards()">Đánh bài</button>
    </div>
  </div>

<script>
const suits = ['♠', '♥', '♦', '♣'];
const ranks = ['3','4','5','6','7','8','9','10','J','Q','K','A','2'];
let deck = [];
for (let s of suits) for (let r of ranks) deck.push(r + s);
deck.sort(() => Math.random() - 0.5);

const players = {
  top: deck.slice(0, 13),
  left: deck.slice(13, 26),
  right: deck.slice(26, 39),
  bottom: deck.slice(39, 52)
};

const turnOrder = ['bottom', 'left', 'top', 'right'];
let currentTurn = 0;

function renderHand(player, isPlayer = false) {
  const div = document.getElementById('hand-' + player);
  div.innerHTML = '';
  players[player].forEach(card => {
    const c = document.createElement('div');
    c.className = 'card' + (!isPlayer ? ' back' : '');
    if (isPlayer) {
      c.innerText = card;
      c.onclick = () => c.classList.toggle('selected');
    }
    div.appendChild(c);
  });
}

function updatePlayed(player, card) {
  document.getElementById('played-cards').innerText = `${player}: ${card}`;
}

function playCards() {
  const selected = Array.from(document.querySelectorAll('#hand-bottom .selected'));
  if (selected.length === 0) return alert("Chọn bài trước!");
  const cards = selected.map(c => c.innerText);
  alert("Bạn đánh: " + cards.join(', '));
  players.bottom = players.bottom.filter(c => !cards.includes(c));
  renderHand('bottom', true);
  updatePlayed('Bạn', cards.join(', '));
  currentTurn = 1;
  setTimeout(machinePlay, 1500);
}

function machinePlay() {
  const playerId = turnOrder[currentTurn];
  const hand = players[playerId];
  if (hand.length === 0) return;
  const card = hand[0];
  updatePlayed(playerId, card);
  players[playerId] = hand.slice(1);
  renderHand(playerId);
  currentTurn = (currentTurn + 1) % 4;
  if (playerId !== 'bottom') setTimeout(machinePlay, 1500);
}

['top','left','right','bottom'].forEach(p => renderHand(p, p==='bottom'));
</script>
</body>
</html>
